<UserControl
    x:Class="Utility.WPF.Demo.Objects.JsonObjectUserControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:local="clr-namespace:Utility.WPF.Demo.Objects"
    xmlns:sys="clr-namespace:System;assembly=System.Runtime"
    xmlns:view="http://schemas.utility.com/objects"
    xmlns:model="clr-namespace:Utility.Models;assembly=Utility.Models"
    xmlns:conv="http://schemas.utility.com/converters"
    d:DesignHeight="450"
    d:DesignWidth="800"
    mc:Ignorable="d">
    <UserControl.Resources>
        <sys:Exception x:Key="exception" />
        <conv:ColorConverter x:Key="ColorConverter"></conv:ColorConverter>

        <DataTemplate x:Key="Ellipse">
            <Rectangle Fill="{Binding Value, Converter={StaticResource ColorConverter}}"></Rectangle>
        </DataTemplate>



        <DataTemplate x:Key="MessageTemplate">
            <TextBlock FontSize="16" FontStyle="Italic" Text="{Binding Value}"></TextBlock>
        </DataTemplate>        
        

        <x:Array x:Key="properties" Type="{x:Type model:SchemaProperty}">
            <model:SchemaProperty Name="Color" Template="Ellipse"></model:SchemaProperty>
        </x:Array>

        <model:Schema x:Key="CharacterSchema" Properties="{StaticResource properties}"/>

        <ObjectDataProvider x:Key="SchemaFromFile"
                ObjectType="{x:Type local:SchemaLoader}"
                MethodName="LoadSchema" >
        </ObjectDataProvider>

        <view:ObjectToTokenConverter x:Key="ObjectToTokenConverter"/>
        
    </UserControl.Resources>
    <DockPanel Name="DockPanel" Visibility="Visible">
        <StackPanel DockPanel.Dock="Top">

            <Label
                Margin="5"
                Content="double-click a value to copy to clipboard"
                FontWeight="DemiBold" />
            <Label
                Margin="5"
                Content="Hover over items to view tool-tip"
                FontWeight="DemiBold" />
        </StackPanel>
        <Grid>
            <UniformGrid>
                <view:JsonControl Object="{Binding Source={StaticResource Characters}, Converter={StaticResource ObjectToTokenConverter}}" Schema="{StaticResource CharacterSchema}"/>
                <view:JsonControl Object="{Binding Source={StaticResource exception}, Converter={StaticResource ObjectToTokenConverter}}" Schema="{Binding Source={StaticResource SchemaFromFile}}"/>
                <DockPanel>
                    <Button DockPanel.Dock="Top" 
                        Click="Button_Click"
                        Height="30" Width="200">
                        Load from clipboard
                    </Button>
                    <view:JsonControl x:Name="JsonControl" />
                </DockPanel>
                  <Grid>
                    <Grid.Resources> 
                          <!--DataTemplate for Published Date column defined in Grid.Resources.  PublishDate is a property on the ItemsSource of type DateTime-->  
                        <DataTemplate x:Key="DateTemplate">
                            <view:JsonControl Object="{Binding Converter={StaticResource ObjectToTokenConverter}}" />
                        </DataTemplate>
                          <!--DataTemplate for the Published Date column when in edit mode.-->  
                        <DataTemplate x:Key="EditingDateTemplate">
                            <DatePicker />
                        </DataTemplate>
                    </Grid.Resources>
                    <DataGrid AutoGenerateColumns="False" ItemsSource="{StaticResource Characters}">
                        <DataGrid.Columns>
                              <!--Custom column that shows the published date-->  
                            <DataGridTemplateColumn
                                CellEditingTemplate="{StaticResource EditingDateTemplate}"
                                CellTemplate="{StaticResource DateTemplate}"
                                Header="Publish Date" />
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </UniformGrid>
        </Grid>
    </DockPanel>
</UserControl>