<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:local="clr-namespace:Utility.WPF.Controls.Objects"
                    xmlns:conv="http://schemas.utility.com/converters"
                    xmlns:res="http://schemas.utility.com/resourcedictionary"
                    xmlns:sb="http://schemas.utility.com/splitbuttons">

    <ResourceDictionary.MergedDictionaries>
        <res:SharedResourceDictionary  Source="/Utility.WPF.Geometries;component/Resources.xaml" />
    </ResourceDictionary.MergedDictionaries>

    <!--Converter for Indentation of items-->
    <!--<tree:TreeListViewConverter x:Key="TreeListViewConverter" />-->

    <local:TemplatesConverter x:Key="TemplatesConverter" />

    <Style x:Key="BasicButtonStyle" TargetType="{x:Type Button}">
        <Setter Property="Background" Value="Transparent"></Setter>
        <Setter Property="BorderBrush" Value="Transparent"></Setter>
        <Setter Property="Height" Value="16"></Setter>
        <Setter Property="Width" Value="16"></Setter>
    </Style>

    <Style x:Key="GridViewColumnHeaderStyle"  TargetType="{x:Type GridViewColumnHeader}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type GridViewColumnHeader}">
                    <Border BorderThickness="0,0,0,0" BorderBrush="Black" Background="Transparent">
                        <TextBlock x:Name="ContentHeader" Text="{TemplateBinding Content}" Padding="5,5,5,0" Width="{TemplateBinding Width}" TextAlignment="Center" />
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="OverridesDefaultStyle" Value="True" />
        <Setter Property="Foreground" Value="Black" />
        <Setter Property="FontFamily" Value="Segoe UI" />
        <Setter Property="FontSize" Value="12" />
    </Style>

    <!--Control Template for TreeViewItem's.-->
    <ControlTemplate TargetType="{x:Type local:TreeListViewItem}" x:Key="TreeListViewItem">
        <!--Grid containing the current information and the subnodes.-->
        <StackPanel>
            <!--Border wrapping the content presenter.-->
            <Border x:Name="Border" Background="Transparent">
                <!--GridViewRowPrsenter containing the current information.-->
                <GridViewRowPresenter
                    Content="{TemplateBinding Header}"
                    Columns="{Binding Columns, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type local:TreeListViewItem},AncestorLevel=2}}" />
            </Border>
            <!--ItemsPresenter containing the subnodes-->
            <ItemsPresenter x:Name="ItemsPresenter" Visibility="Collapsed" />
        </StackPanel>
        <ControlTemplate.Triggers>
            <!--Trigger used to show the sub items-->
            <Trigger Property="IsExpanded" Value="True">
                <Setter TargetName="ItemsPresenter" Property="Visibility" Value="Visible" />
            </Trigger>
            <!--Trigger used to change the color based on selection-->
            <Trigger Property="IsSelected" Value="true">
                <!--Change the background color-->
                <Setter TargetName="Border" Property="Background"
                    Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                <!--Change the foreground color-->
                <Setter Property="Foreground"
                    Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}" />
            </Trigger>
            <!--Trigger used to change the color based on selection-->
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsSelected" Value="true" />
                    <Condition Property="IsSelectionActive" Value="false" />
                </MultiTrigger.Conditions>
                <!--Change the background color-->
                <Setter TargetName="Border" Property="Background"
                    Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                <!--Change the foreground color-->
                <Setter Property="Foreground"
                    Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
            </MultiTrigger>
            <!--Trigger used to change the color based on the status of the item-->
            <Trigger Property="IsEnabled" Value="false">
                <!--Change the foreground color-->
                <Setter Property="Foreground"
                    Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <ControlTemplate TargetType="{x:Type local:TreeListViewItem}" x:Key="TreePropertyListViewItem">
        <!--Grid containing the current information and the subnodes.-->
        <Grid>
            <Grid.Resources>
                <Style TargetType="{x:Type sb:PopupButton}">
                    <Setter Property="BorderBrush" Value="Transparent"></Setter>
                    <Setter Property="Background" Value="Transparent"></Setter>
                    <Setter Property="HorizontalContentAlignment" Value="Center"></Setter>
                    <Setter Property="HorizontalAlignment" Value="Center"></Setter>
                    <Setter Property="VerticalContentAlignment" Value="Center"></Setter>
                    <Setter Property="VerticalAlignment" Value="Center"></Setter>
                </Style>
            </Grid.Resources>

            <StackPanel Orientation="Horizontal">
                <Border x:Name="Border" Background="Transparent" BorderBrush="{TemplateBinding Foreground}">
                    <Grid>
                        <ContentPresenter x:Name="PART_Header"
                            ContentSource="Header"
                            HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" />
                    </Grid>
                </Border>
                <ItemsPresenter x:Name="ItemsPresenter" Margin="0,0,18,0" />
            </StackPanel>

            <sb:PopupButton PopupPlacement="Bottom"
                            Margin="0,0,-5,0"
                            VerticalAlignment="Top"
                            HorizontalAlignment="Right">
                <sb:PopupButton.Header>
                    <Path Data="{StaticResource SettingsGeometry}"   Height="12"  Stretch="Uniform"  Fill="Gray"></Path>
                </sb:PopupButton.Header>
                <sb:PopupButton.Content>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <!--<StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,5">
                                    <CheckBox Content="Enable Custom Template" Margin="0,0,0,0" />
                                </StackPanel>-->

                        <StackPanel Grid.Row="2" Orientation="Horizontal">
                            <TextBlock Text="Template" VerticalAlignment="Center" Margin="0,0,0,5" />
                            <!--<ComboBox SelectedIndex="0">
                                -->
                            <!--<ComboBox.ItemsSource>
                                    <MultiBinding Converter="{StaticResource TemplatesConverter}">
                                        <Binding RelativeSource="{RelativeSource  AncestorType=local:JsonControl}" />
                                        <Binding Path="." />
                                    </MultiBinding>
                                </ComboBox.ItemsSource>-->
                            <!--
                            </ComboBox>-->
                        </StackPanel>
                    </Grid>
                </sb:PopupButton.Content>
            </sb:PopupButton>
        </Grid>
        <ControlTemplate.Triggers>
            <!--Trigger used to show the sub items-->
            <!--<Trigger Property="IsExpanded" Value="True">
                <Setter TargetName="ItemsPresenter" Property="Visibility" Value="Visible" />
            </Trigger>-->
            <!--Trigger used to change the color based on selection-->
            <Trigger Property="IsSelected" Value="true">
                <!--Change the background color-->
                <Setter TargetName="Border" Property="Background"
                    Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                <!--Change the foreground color-->
                <Setter Property="Foreground"
                    Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}" />
            </Trigger>
            <!--Trigger used to change the color based on selection-->
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsSelected" Value="true" />
                    <Condition Property="IsSelectionActive" Value="false" />
                </MultiTrigger.Conditions>
                <!--Change the background color-->
                <Setter TargetName="Border" Property="Background"
                    Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                <!--Change the foreground color-->
                <Setter Property="Foreground"
                    Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
            </MultiTrigger>
            <!--Trigger used to change the color based on the status of the item-->
            <Trigger Property="IsEnabled" Value="false">
                <!--Change the foreground color-->
                <Setter Property="Foreground"
                    Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <ControlTemplate TargetType="{x:Type local:TreeListViewItem}" x:Key="TreeObjectListViewItem">
        <!--Grid containing the current information and the subnodes.-->
        <StackPanel Orientation="Vertical">
            <Border x:Name="Border" Background="Transparent" BorderBrush="{TemplateBinding Foreground}">
                <ContentPresenter x:Name="PART_Header"

                                        ContentSource="Header"
                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" />
            </Border>
            <ItemsPresenter x:Name="ItemsPresenter" />
        </StackPanel>
        <ControlTemplate.Triggers>
            <!--Trigger used to show the sub items-->
            <!--<Trigger Property="IsExpanded" Value="True">
                <Setter TargetName="ItemsPresenter" Property="Visibility" Value="Visible" />
            </Trigger>-->
            <!--Trigger used to change the color based on selection-->
            <Trigger Property="IsSelected" Value="true">
                <!--Change the background color-->
                <Setter TargetName="Border" Property="Background"
                    Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                <!--Change the foreground color-->
                <Setter Property="Foreground"
                    Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}" />
            </Trigger>
            <!--Trigger used to change the color based on selection-->
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsSelected" Value="true" />
                    <Condition Property="IsSelectionActive" Value="false" />
                </MultiTrigger.Conditions>
                <!--Change the background color-->
                <Setter TargetName="Border" Property="Background"
                    Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                <!--Change the foreground color-->
                <Setter Property="Foreground"
                    Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
            </MultiTrigger>
            <!--Trigger used to change the color based on the status of the item-->
            <Trigger Property="IsEnabled" Value="false">
                <!--Change the foreground color-->
                <Setter Property="Foreground"
                    Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <ControlTemplate x:Key="RootControlTemplate"  TargetType="{x:Type local:TreeListViewItem}">
        <ControlTemplate.Resources>
            <!--Apply this style to all 'TreeListViewExpander's.-->
            <!--<Style TargetType="tree:TreeListViewExpander">
                                <Setter Property="Template" Value="{StaticResource TreeListViewExpander}" />
                            </Style>-->
        </ControlTemplate.Resources>
        <!--Create a standard border around the 'TreeListView'.-->
        <Border Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}">
            <!--ScrollViewer providing horizontal scrolling functionality
                        for both, content and headers.-->
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"></RowDefinition>
                    <RowDefinition Height="*"></RowDefinition>
                </Grid.RowDefinitions>
                <ScrollViewer HorizontalScrollBarVisibility="Auto"
                                      VerticalScrollBarVisibility="Disabled">
                    <!--Grid containing the header row and all the content rows.-->
                    <Grid>
                        <Grid.RowDefinitions>
                            <!--The header row.-->
                            <RowDefinition Height="Auto" />
                            <!--The content row.-->
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <!--The header row.-->
                        <GridViewHeaderRowPresenter Columns="{TemplateBinding Columns}"
                                                            ColumnHeaderContainerStyle="{StaticResource GridViewColumnHeaderStyle}"
                                    AllowsColumnReorder="{TemplateBinding AllowsColumnReorder}" />
                        <!--ScrollViewer providing vertical scrolling
                                functionality for the content.-->
                        <ScrollViewer HorizontalScrollBarVisibility="Disabled"
                                              VerticalScrollBarVisibility="Auto"
                                              Grid.Row="1">
                            <!--ItemsPresenter containg the content-->
                            <ItemsPresenter />
                        </ScrollViewer>
                    </Grid>
                </ScrollViewer>
                <Grid Grid.Row="1">
                    <Button Style="{StaticResource BasicButtonStyle}" Command="{Binding Source={x:Static local:Commands.FooCommand}}">
                        <Path  Stroke="Gray" StrokeThickness="2"   Stretch="UniformToFill" Data="{StaticResource Plus}" />
                    </Button>
                </Grid>
            </Grid>
        </Border>
    </ControlTemplate>

    <local:JsonContainerStyle2Selector x:Key="JsonContainerStyle2Selector">
        <local:JsonContainerStyle2Selector.Resources>
            <res:SharedResourceDictionary Source="/Utility.WPF.Controls.Objects;component/Themes/Dictionary1.xaml" />
        </local:JsonContainerStyle2Selector.Resources>
    </local:JsonContainerStyle2Selector>

    <Style x:Key="TreeListViewItemStyle"  TargetType="{x:Type local:TreeListViewItem}">
        <Setter Property="Template" Value="{StaticResource TreeListViewItem}" />
    </Style>

    <Style x:Key="PropertyStyle"  TargetType="{x:Type local:TreeListViewItem}" BasedOn="{StaticResource {x:Type TreeViewItem}}">
        <Setter Property="Template" Value="{StaticResource TreePropertyListViewItem}" />
    </Style>

    <Style x:Key="ObjectStyle"  TargetType="{x:Type local:TreeListViewItem}" BasedOn="{StaticResource {x:Type TreeViewItem}}">
        <Setter Property="Template" Value="{StaticResource TreeObjectListViewItem}" />
    </Style>

    <Style x:Key="RootStyle" TargetType="{x:Type local:TreeListViewItem}">
        <Setter Property="ItemContainerStyleSelector" Value="{StaticResource JsonContainerStyle2Selector}" />
        <Setter Property="Template" Value="{StaticResource RootControlTemplate}" />
        <Setter Property="Schema" Value="{Binding Schema, RelativeSource={RelativeSource AncestorType={x:Type local:JsonControl}}}"></Setter>
    </Style>

    <Style x:Key="RootValueStyle" TargetType="{x:Type local:TreeListViewItem}">
        <Setter Property="Template" Value="{StaticResource TreeObjectListViewItem}" />
        <Setter Property="Schema" Value="{Binding Schema, RelativeSource={RelativeSource AncestorType={x:Type local:JsonControl}}}"></Setter>
    </Style>
</ResourceDictionary>