<Window x:Class="Utility.WPF.Demo.SandBox.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
        xmlns:sandbox="clr-namespace:Utility.WPF.Demo.SandBox" 
        xmlns:i="http://schemas.microsoft.com/xaml/behaviors" 
        xmlns:sys="clr-namespace:System.Reactive.Linq;assembly=System.Reactive"
        xmlns:local="clr-namespace:Utility.WPF.SandBox"
        xmlns:local2="clr-namespace:Utility.WPF.Demo.SandBox"
        xmlns:dm="clr-namespace:Utility.WPF.Demo.Data.Model;assembly=Utility.WPF.Demo.Data"
        xmlns:pt="clr-namespace:Utility.WPF.Controls.PropertyTrees;assembly=Utility.WPF.Controls.PropertyTrees"
        xmlns:conv="http://schemas.utility.com/converters" 
        xmlns:res="http://schemas.utility.com/resourcedictionary"
        mc:Ignorable="d"
        Title="MainWindow" Height="450" Width="800">

    <FrameworkElement.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Utility.WPF.Demo.Data;component/DataTemplate/Character.xaml"/>

                <res:GeometryResourceDictionary />
            </ResourceDictionary.MergedDictionaries>

            <local2:LastItemConverter x:Key="LastItemConverter"/>
            <local2:MathConverter x:Key="MathConverter"></local2:MathConverter>



            <Storyboard x:Key="Storyboard5">
                <!-- Animate the Background color to change -->
                <BooleanAnimationUsingKeyFrames Storyboard.TargetProperty="IsExpanded" Duration="0:0:4">
                    <DiscreteBooleanKeyFrame Value="True" KeyTime="0:0:0" />
                </BooleanAnimationUsingKeyFrames>
                <BooleanAnimationUsingKeyFrames Storyboard.TargetName="Toggle" Storyboard.TargetProperty="IsChecked">
                    <DiscreteBooleanKeyFrame Value="False" KeyTime="0:0:4" />
                </BooleanAnimationUsingKeyFrames>
            </Storyboard>

            <Storyboard x:Key="Storyboard1">
                <DoubleAnimation Storyboard.TargetName="Var_Animation_0to1" Storyboard.TargetProperty="(FrameworkElement.Width)" From="0.33" To="1" Duration="0:0:1">
                </DoubleAnimation>
            </Storyboard>


            <Style  TargetType="{x:Type local2:BreadCrumbs}">
                <Style.Resources>

                </Style.Resources>

                <Setter Property="SnapsToDevicePixels"
                Value="true" />
                <Setter Property="Focusable"
                Value="False" />
                <Setter Property="ItemsPanel">
                    <Setter.Value>
                        <ItemsPanelTemplate>
                            <VirtualizingStackPanel FlowDirection="LeftToRight" Orientation="Horizontal" />
                        </ItemsPanelTemplate>
                    </Setter.Value>
                </Setter>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate>
                            <ControlTemplate.Resources>


                            </ControlTemplate.Resources>
                            <Grid>

                                <Border x:Name="Var_Animation_0to1" Width="0.33"/>



                                <ScrollViewer HorizontalScrollBarVisibility="Hidden"  VerticalScrollBarVisibility="Disabled" Background="Transparent" FlowDirection="RightToLeft" HorizontalAlignment="{TemplateBinding HorizontalAlignment}">
                                    <FrameworkElement.Width>
                                        <MultiBinding Converter="{StaticResource MathConverter}" ConverterParameter="xy">
                                            <Binding ElementName="Var_Animation_0to1" Path="Width"/>
                                            <Binding ElementName="BackBorder" Path="ActualWidth"/>
                                        </MultiBinding>
                                    </FrameworkElement.Width>
                                    <i:Interaction.Behaviors>
                                        <local2:ScrollToBottomBehavior/>
                                    </i:Interaction.Behaviors>

                                    <ItemsPresenter x:Name="BackBorder" SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}" />

                                </ScrollViewer>


                                <ToggleButton HorizontalAlignment="Left" x:Name="Toggle">
                                    <ToggleButton.Template>
                                        <ControlTemplate TargetType="ToggleButton">
                                            <Border  >

                                                <Grid Background="{TemplateBinding Background}" >                
                                                    <Path 
                                        
                                        x:Name="Arrow"                               
                                        Fill="{TemplateBinding Foreground}"                                        
                                        Margin="3,0,4,-4" 
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Center"
                                        Data="{StaticResource RightChevronGeometry2}"
                                        />

                                                </Grid>
                                            </Border>
                                        </ControlTemplate>
                                    </ToggleButton.Template>

                                    <ToggleButton.Style>

                                        <Style TargetType="ToggleButton">

                                            <Setter Property="Background" Value="White"></Setter>
                                            <Setter Property="Foreground" Value="Orange"></Setter>
                                            <Setter Property="BorderBrush" Value="Transparent"></Setter>


                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsMouseOver, RelativeSource={RelativeSource Self}}" Value="True">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetProperty="(Button.Background).(SolidColorBrush.Color)"
                                                        To="LightGreen"
                                                        Duration="0:0:0.3"/>
                                                                <ColorAnimation Storyboard.TargetProperty="(Button.Foreground).(SolidColorBrush.Color)"
                                                        To="Black"
                                                        Duration="0:0:0.3"/>
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                    <DataTrigger.ExitActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation Storyboard.TargetProperty="(Button.Background).(SolidColorBrush.Color)"
                                                        To="White"
                                                        Duration="0:0:0.3"/>
                                                                <ColorAnimation Storyboard.TargetProperty="(Button.Foreground).(SolidColorBrush.Color)"
                                                        To="Orange"
                                                        Duration="0:0:0.3"/>
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.ExitActions>
                                                </DataTrigger>
                                                

                                                <DataTrigger Binding="{Binding IsChecked, RelativeSource={RelativeSource Self}}" Value="True">
                                                    <DataTrigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation  Storyboard.TargetProperty="(Button.Foreground).(SolidColorBrush.Color)"
                                                        To="Black"
                                                        Duration="0:0:0"/>
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.EnterActions>
                                                    <DataTrigger.ExitActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <ColorAnimation  Storyboard.TargetProperty="(Button.Foreground).(SolidColorBrush.Color)"
                                                        To="Orange"
                                                        Duration="0:0:0"/>
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </DataTrigger.ExitActions>
                                                </DataTrigger>

                                       
                                            </Style.Triggers>




                                        </Style>
                                    </ToggleButton.Style>
                         

                                </ToggleButton>
                            </Grid>

                            <ControlTemplate.Triggers>
                                <DataTrigger Value="True">
                                    <DataTrigger.Binding>
                                        <Binding Path="IsExpanded" RelativeSource="{RelativeSource Mode=Self}" />
                                    </DataTrigger.Binding>
                                    <!--<Setter TargetName="Arrow" Property="Fill" Value="Red" />-->
                                    <DataTrigger.EnterActions>
                                        <BeginStoryboard Name="sb" Storyboard="{StaticResource Storyboard1}">
                                        </BeginStoryboard>
                                    </DataTrigger.EnterActions>
                                    <DataTrigger.ExitActions>
                                        <StopStoryboard BeginStoryboardName="sb" />
                                    </DataTrigger.ExitActions>
                                </DataTrigger>


                                <!--MouseOver trigger to change background-->
                                <DataTrigger Binding="{Binding IsChecked,ElementName=Toggle}" Value="True">
                                    <DataTrigger.EnterActions>
                                        <BeginStoryboard Name="sb2" Storyboard="{StaticResource Storyboard5}"/>
                                    </DataTrigger.EnterActions>
                                    <DataTrigger.ExitActions>
                                        <StopStoryboard BeginStoryboardName="sb2" />
                                    </DataTrigger.ExitActions>
                                </DataTrigger>

                            </ControlTemplate.Triggers>

                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Setter Property="ItemContainerStyle">
                    <Setter.Value>
                        <Style>
                            <Setter Property="Control.Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="ContentControl">


                                        <StackPanel Orientation="Horizontal" Background="Transparent" x:Name="grid" TextBlock.FontSize="10">


                                            <!-- animated Border.Width    From 0 to (TotalWidth-SliderWidth) -->

                                            <Path 
                                        
                                        x:Name="Arrow"                               
                                        Fill="Black"
                                        Margin="4,0,4,-4" 
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Data="{StaticResource RightChevronGeometry2}"
                                        />
                                            <ContentPresenter Width="{Binding Path=ContainerWidth, RelativeSource={RelativeSource AncestorType=local2:BreadCrumbs}}" VerticalAlignment="Center"/>
                                        </StackPanel>

                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </Setter.Value>
                </Setter>
            </Style>

        </ResourceDictionary>
    </FrameworkElement.Resources>



    <Grid x:Name="MainGrid">
        <Grid.RowDefinitions>
            <RowDefinition Height="30"></RowDefinition>
            <RowDefinition Height="Auto"></RowDefinition>
            <RowDefinition Height="30"></RowDefinition>
            <RowDefinition Height="*"></RowDefinition>
            <RowDefinition Height="*"></RowDefinition>
        </Grid.RowDefinitions>

        <!--<UniformGrid Rows="1">
            <Ellipse Fill="Red" Height="20" Width="20"></Ellipse>
            <Ellipse Fill="Red" Height="20" Width="20"></Ellipse>
            <Ellipse Fill="Red" Height="20" Width="20"></Ellipse>
        </UniformGrid>-->
        <local:HatchSwitchView/>

        <local2:BreadCrumbs Grid.Row="2" 
                ItemsSource="{Binding Source={x:Type local2:MainWindow}, Converter={x:Static conv:TypeHierarchyConverter.Instance}}">

        </local2:BreadCrumbs>
        
        

   
        <ToggleButton Grid.Row="3" Width="200" Height="50" Content="Hover over me">
            <ToggleButton.Template>
                <ControlTemplate TargetType="ToggleButton">
                    <Grid Background="{TemplateBinding Background}">
                        <!-- Define the mouseover visual state -->
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal">
                                    <Storyboard>
                                        <ColorAnimation Storyboard.TargetProperty="(Grid.Background).(SolidColorBrush.Color)"
                                                        To="Transparent" Duration="0:0:0.3"/>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="MouseOver">
                                    <Storyboard>
                                        <ColorAnimation Storyboard.TargetProperty="(Grid.Background).(SolidColorBrush.Color)"
                                                        To="LightGreen" Duration="0:0:0.3"/>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>

                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                    </Grid>
                </ControlTemplate>
            </ToggleButton.Template>
        </ToggleButton>

        <Path Data="{DynamicResource LeftArrow}" StrokeEndLineCap="Round" Grid.Row="4" Stretch="Uniform" StrokeThickness="48" Stroke="Black"></Path>
        <!--<pt:PropertyTree Grid.Row="1" Object="{Binding Source={StaticResource Character}}"></pt:PropertyTree>-->

    </Grid>
</Window>