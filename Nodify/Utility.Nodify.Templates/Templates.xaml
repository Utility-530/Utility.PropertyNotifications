<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"                  
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:core="clr-namespace:Utility.Nodify.ViewModels;assembly=Utility.Nodify.ViewModels"
                    xmlns:nodify="https://miroiu.github.io/nodify" 
                    xmlns:op="clr-namespace:Utility.Nodify.Operations.Infrastructure;assembly=Utility.Nodify.Base"
                    xmlns:shared="http://schemas.microsoft.com/netfx/2009/xaml/presentation" 
                    xmlns:tabs="http://schemas.utility.com/tabs"
                    xmlns:conv="http://schemas.utility.com/converters">



    <shared:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
    <conv:CountToBooleanConverter x:Key="CountToBooleanConverter" ></conv:CountToBooleanConverter>
    <!--<local:ItemToListConverter x:Key="ItemToListConverter" />-->


    <HierarchicalDataTemplate DataType="{x:Type core:MenuItemViewModel}"  ItemsSource="{Binding Children}">
        <Button Content="{Binding Content.Key}"
                                Command="{Binding Command}"
                                Background="Transparent"
                                BorderBrush="Transparent"
                                Foreground="{DynamicResource ForegroundBrush}"
                                Padding="3"
                                Cursor="Hand"
                                HorizontalContentAlignment="Left">
            <Button.Style>
                <Style TargetType="{x:Type Button}">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="{x:Type Button}">
                                <Border Name="Border"
                                                        Background="{TemplateBinding Background}"
                                                        Padding="{TemplateBinding Padding}">
                                    <ContentPresenter />
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver"
                                                             Value="True">
                                        <Setter Property="Background"
                                                                TargetName="Border"
                                                                Value="{DynamicResource NodeInput.BorderBrush}" />
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </Button.Style>
        </Button>
    </HierarchicalDataTemplate>

    
    <DataTemplate DataType="{x:Type core:MenuViewModel}">
        <Border Padding="7" MaxWidth="220"
            CornerRadius="3"
            Background="{DynamicResource Node.BackgroundBrush}"
            BorderBrush="{StaticResource NodifyEditor.SelectionRectangleStrokeBrush}"
            BorderThickness="2"
            Visibility="{Binding IsVisible, Converter={StaticResource BooleanToVisibilityConverter}}">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <!-- Define the hierarchical data template for menu items -->

                <TreeView ItemsSource="{Binding Items}" BorderThickness="0">
                    <TreeView.ItemContainerStyle>
                        <Style TargetType="TreeViewItem">
                            <Setter Property="IsExpanded" Value="{Binding IsExpanded}" />
                        </Style>
                    </TreeView.ItemContainerStyle>
                </TreeView>
            </ScrollViewer>
        </Border>
    </DataTemplate>


    <DataTemplate DataType="{x:Type core:TabsViewModel}">
        <tabs:TabControlEx ItemsSource="{Binding Tabs}"
                             SelectedItem="{Binding SelectedEditor}" 
                             AddTabCommand="{Binding AddEditorCommand}"
                             AutoScrollToEnd="{Binding AutoSelectNewEditor}">
            <tabs:TabControlEx.ItemContainerStyle>
                <Style TargetType="{x:Type tabs:TabItemEx}" 
                       BasedOn="{StaticResource {x:Type tabs:TabItemEx}}">
                    <Setter Property="Header" 
                            Value="{Binding Name}"/>
                    <Setter Property="CloseTabCommand" 
                            Value="{Binding CloseCommand}"/>
                    <Setter Property="CloseTabCommandParameter" 
                            Value="{Binding Id}"/>
                </Style>
            </tabs:TabControlEx.ItemContainerStyle>
        </tabs:TabControlEx>
    </DataTemplate>

    <DataTemplate DataType="{x:Type core:TabViewModel}">
        <ContentControl Content="{Binding Content}"/>
    </DataTemplate>



</ResourceDictionary>