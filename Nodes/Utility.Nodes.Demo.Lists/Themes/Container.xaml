<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:local="clr-namespace:Utility.Nodes.Demo.Lists"
                    xmlns:utl="http://schemas.utility.com/utilitywpf"
                    xmlns:att="http://schemas.utility.com/attached" 
                    xmlns:dockablz="http://dragablz.net/winfx/xaml/dockablz"
                    xmlns:dragablz="http://dragablz.net/winfx/xaml/dragablz"
                    xmlns:filters="clr-namespace:Utility.Nodes.WPF;assembly=Utility.WPF.Trees" 
                    xmlns:nwpf="clr-namespace:Utility.Nodes.WPF;assembly=Utility.Nodes.WPF"
                    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes" 
                    xmlns:nodes="clr-namespace:Utility.Nodes;assembly=Utility.Nodes"
                    xmlns:markup="http://schemas.utility.com/markup" 
                    xmlns:conv="http://schemas.utility.com/converters"
                    xmlns:t="http://schemas.utility.com/trees">

    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="/Utility.WPF.Geometries;component/Resources.xaml"/>
        <ResourceDictionary Source="/Themes/Master.xaml"/>
    </ResourceDictionary.MergedDictionaries>

    <filters:StyleSelector x:Key="StyleSelector" DefaultStyle="ViewContentStyle"/>

    <Style x:Key="SettingsToggleStyle" TargetType="{x:Type ToggleButton}">
        <Setter Property="Background" Value="Transparent"></Setter>
        <Setter Property="IsChecked" Value="True"></Setter>
        <Setter Property="BorderThickness" Value="0"></Setter>
        <Setter Property="Content" >
            <Setter.Value>
                <Path Data="{StaticResource SettingsGeometry}" Fill="White"  Stroke="Gray" StrokeThickness="1"/>
            </Setter.Value>
        </Setter>
    </Style>

    <local:CustomDataTemplateSelector x:Key="DataTemplateSelector">
        <local:CustomDataTemplateSelector.DefaultTemplate>
            <DataTemplate DataType="{x:Type nodes:NodeViewModel}">
                <t:CustomTreeView ItemsSource="{markup:Array {Binding }}"/>
            </DataTemplate>
        </local:CustomDataTemplateSelector.DefaultTemplate>
        <local:CustomDataTemplateSelector.MasterTemplate>
            <StaticResource ResourceKey="MasterTemplate"/>
        </local:CustomDataTemplateSelector.MasterTemplate>
    </local:CustomDataTemplateSelector>

    <DataTemplate DataType="{x:Type local:ContainerModel}">
        <utl:SplitControl att:Ex.ToggleStyle="{StaticResource SettingsToggleStyle}" >
            <utl:SplitControl.Header>
                <TextBlock Text="Settings"/>
            </utl:SplitControl.Header>
            <utl:SplitControl.Content>
                <dockablz:Layout>
                    <dragablz:TabablzControl
                        Style="{DynamicResource MaterialDesignTabablzControlStyle}"
                x:Name="InitialTabablzControl"                
                ItemContainerStyleSelector="{StaticResource StyleSelector}"
                ClosingItemCallback="{Binding ClosingTabItemHandler}"
                ItemsSource="{Binding Children}"
                SelectedItem="{Binding Current, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                ShowDefaultCloseButton="True">
                        <dragablz:TabablzControl.InterTabController>
                            <dragablz:InterTabController InterTabClient="{Binding InterTabClient}" />
                        </dragablz:TabablzControl.InterTabController>
                        <dragablz:TabablzControl.HeaderItemTemplate>
                            <DataTemplate DataType="{x:Type nodes:NodeViewModel}">
                                <StackPanel>
                                    <Border CornerRadius="2" BorderThickness="1" x:Name="Rex">
                                        <TextBlock Margin="0,0,0,0" HorizontalAlignment="Center" Text="{Binding Name}" />
                                    </Border>
                                </StackPanel>
                                <DataTemplate.Triggers>
                                    <DataTrigger Binding="{Binding IsSelected}" Value="True">
                                        <DataTrigger.Setters>
                                            <Setter TargetName="Rex" Property="BorderBrush" Value="CadetBlue"></Setter>
                                        </DataTrigger.Setters>
                                    </DataTrigger>
                                </DataTemplate.Triggers>
                            </DataTemplate>
                        </dragablz:TabablzControl.HeaderItemTemplate>
                        <TabControl.ContentTemplateSelector                            >
                            <StaticResource ResourceKey="DataTemplateSelector"/>
                        </TabControl.ContentTemplateSelector>
                    </dragablz:TabablzControl>
                </dockablz:Layout>
            </utl:SplitControl.Content>
        </utl:SplitControl>

    </DataTemplate>

</ResourceDictionary>